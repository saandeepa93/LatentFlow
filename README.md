<!-- BEST CONFIG - RAF_13
SETUP: usual loader, no preprocessing of input. Tau 0.33. Trick is to reduce num_blocks and increase num_coupling

BEST: raf_33 
SETUP: 1.5 tau2, pretrained enet_b0_7, normalization loader, good average accuracy ~80, 557
SETUP: 1.5 tau2, pretrained enet_b0_8_best_vgaf, normalization loader, worse average accuracy ~78, 545 -->
<!-- 
ic| res2: (0.873,
array([[282,   17,    2,    6,    4,    3,   13],
                     [   4,   34,    0,    5,    0,    2,    0],
                     [   5,    1,  103,   16,   14,   11,   21],
                     [   3,    2,    6, 1104,    8,    1,   10],
                     [   5,   13,   13,    6,  422,    4,   36],
                     [   4,    5,   10,   10,    3,  136,    4],
                     [  26,    2,   26,   38,   27,    5,  596]])
           array([0.8571, 0.4594, 0.6437, 0.9316 , 0.8828,
                 0.8395, 0.8764]))

ic| res2: (0.865,
           array([[ 290,    4,    4,    2,    5,    4,   20],
                 [  19,   34,    2,    3,   10,    3,    3],
                 [   6,    0,  106,    7,   11,    9,   21],
                 [   6,    3,   15, 1101,    5,   10,   45],
                 [   3,    2,   18,    9,  415,    2,   29],
                 [   5,    5,   12,    3,    4,  129,    4],
                 [  22,    0,   27,    8,   42,    2,  579]]),
           array([0.88145897, 0.45945946, 0.6625    , 0.92911392, 0.86820084,
                 0.7962963 , 0.85147059]))




RAF_34
SETUP: 1.5 tau2, 0.07 tau, pretrained enet_b0_8_AFEW, normalization loader, average accuracy ~78.6, 549

res2: (0.872,
           array([[ 286,    4,    0,   12,    4,    4,   19],
                 [  17,   38,    0,    4,    7,    5,    3],
                 [   4,    0,   97,   16,   10,   11,   22],
                 [   6,    1,    4, 1135,    4,    3,   32],
                 [   7,    1,   17,   15,  394,    3,   41],
                 [   3,    1,    9,    6,    2,  137,    4],
                 [  24,    0,   15,   21,   32,    1,  587]]),
           array([0.86930091, 0.51351351, 0.60625   , 0.95780591, 0.82426778,
                 0.84567901, 0.86323529]))


RAF 35
SETUP: 1.5 tau2, pretrained enet_b0_8_best_vgaf, normalization loader, no randomscale, only perspective 
res2: (0.875,
           array([[ 295,    5,    0,    4,    3,    5,   17],
                 [  16,   35,    1,    4,   10,    6,    2],
                 [   3,    0,   86,   14,   25,   14,   18],
                 [   4,    1,    2, 1125,    5,   12,   36],
                 [   5,    5,    9,   12,  414,    1,   32],
                 [   2,    1,    6,    2,    4,  142,    5],
                 [  18,    0,   10,   25,   38,    2,  587]]),
           array([0.89665653, 0.47297297, 0.5375    , 0.94936709, 0.86610879,
                 0.87654321, 0.86323529])) -->

<!-- 

```
RAF 41
Stage2 with likelihood
ic| res2: (0.877,
           array([[ 289,    6,    4,    5,    5,    3,   17],
                 [  17,   40,    2,    3,    5,    6,    1],
                 [   2,    0,  109,   10,   13,    8,   18],
                 [   5,    2,    1, 1110,    8,    6,   53],
                 [   4,    3,   14,   13,  416,    2,   26],
                 [   1,    1,   10,    5,    3,  136,    6],
                 [  17,    0,   16,   14,   41,    1,  591]]),
           array([0.87841945, 0.54054054, 0.68125   , 0.93670886, 0.87029289,
                 0.83950617, 0.86911765]))


stage2 with training.
ic| val_conf: array([[ 280,   16,    3,    3,    5,    1,   15],
                     [   8,   41,    0,    3,    2,    2,    0],
                     [   3,    2,   95,    1,   10,    6,    6],
                     [   7,    2,   13, 1120,   11,    6,   19],
                     [   6,    6,   16,    9,  420,    3,   34],
                     [   6,    6,   11,    6,    4,  139,    1],
                     [  19,    1,   22,   43,   26,    5,  605]])
train_loss: 4.2084; train_acc: 0.908;val_loss: 4.53; val_acc: 0.869;best_acc: 0.88;
``` -->



**SOTA**
```
RAF 44
Stage2 with likelihood
ic| res2: (0.919,
           array([[ 303,    3,    1,    3,    4,    6,    9],
                 [   8,   52,    0,    5,    5,    3,    1],
                 [   4,    1,  112,   12,   10,    7,   14],
                 [   7,    4,    5, 1141,    7,    7,   14],
                 [   9,    6,    6,   16,  423,    7,   11],
                 [   4,    1,    6,    4,    1,  140,    6],
                 [   9,    1,    7,    2,    9,    4,  648]]),
           array([0.92097264, 0.7027027 , 0.7       , 0.9628692 , 0.88493724,
                 0.86419753, 0.95294118]))
```

*****************************************************************************************************

<!-- 


ic| res2: (0.86,
           array([[ 297,   10,    4,    5,    3,    2,    8],
                 [  10,   49,    2,    1,    4,    7,    1],
                 [   8,    2,   84,    8,   23,   15,   20],
                 [  14,    6,    7, 1101,    7,    5,   45],
                 [   5,   13,   12,   10,  410,    4,   24],
                 [   3,    3,   11,    4,    1,  135,    5],
                 [  30,    1,   13,   20,   52,    3,  561]]),
           array([0.90273556, 0.66216216, 0.525     , 0.92911392, 0.85774059,
                 0.83333333, 0.825     ]))





                 array([[ 297,   16,    6,   10,    5,    5,   27],
                     [   4,   37,    0,    2,    1,    5,    0],
                     [   5,    0,  101,   17,   12,   13,   21],
                     [   2,    2,    6, 1104,    8,    3,   11],
                     [   6,   14,   17,   10,  431,    5,   43],
                     [   3,    4,    8,    6,    1,  126,    3],
                     [  12,    1,   22,   36,   20,    5,  575]])
           array([0.9027, 0.50, 0.6312, 0.9316 , 0.9016,
                 0.7777, 0.8455])) -->